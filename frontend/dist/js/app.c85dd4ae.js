(function(){"use strict";var e={1178:function(e,t,s){var a=s(5130),r=s(6768);const o={id:"app"};function n(e,t,s,a,n,i){const l=(0,r.g2)("router-view");return(0,r.uX)(),(0,r.CE)("div",o,[(0,r.bF)(l)])}var i={name:"App"},l=s(1241);const d=(0,l.A)(i,[["render",n]]);var p=d;const u={class:"auth-container"};function c(e,t,s,a,o,n){const i=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)("div",u,[(0,r.bF)(i,{class:"auth-link",to:"/auth/login"},{default:(0,r.k6)((()=>t[0]||(t[0]=[(0,r.eW)("–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è")]))),_:1}),(0,r.bF)(i,{class:"auth-link",to:"/auth/signup"},{default:(0,r.k6)((()=>t[1]||(t[1]=[(0,r.eW)("–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è")]))),_:1})])}var h={name:"AuthComponent"};const g=(0,l.A)(h,[["render",c],["__scopeId","data-v-1963ee16"]]);var w=g,v=s(4232);const k={class:"login-container"},S={class:"login-form"},m={class:"input-wrapper"},f={class:"input-wrapper"},P=["type"],T={class:"password-status"},_=["disabled"];function L(e,t,s,o,n,i){return(0,r.uX)(),(0,r.CE)("div",k,[(0,r.Lk)("div",S,[t[6]||(t[6]=(0,r.Lk)("h1",null,"–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è",-1)),(0,r.Lk)("form",{onSubmit:t[5]||(t[5]=(0,a.D$)(((...e)=>i.signin&&i.signin(...e)),["prevent"]))},[(0,r.Lk)("div",m,[(0,r.bo)((0,r.Lk)("input",{type:"text",placeholder:"–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω","onUpdate:modelValue":t[0]||(t[0]=e=>n.login=e),onInput:t[1]||(t[1]=(...e)=>i.handleLoginInput&&i.handleLoginInput(...e)),required:""},null,544),[[a.Jo,n.login]])]),(0,r.Lk)("div",f,[(0,r.bo)((0,r.Lk)("input",{type:i.passwordInputType,placeholder:"–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å","onUpdate:modelValue":t[2]||(t[2]=e=>n.password=e),onInput:t[3]||(t[3]=(...e)=>i.handlePasswordInput&&i.handlePasswordInput(...e)),required:""},null,40,P),[[a.hp,n.password]]),(0,r.Lk)("span",{class:"input-icon",onClick:t[4]||(t[4]=(...e)=>i.togglePasswordVisibility&&i.togglePasswordVisibility(...e))},(0,v.v_)(i.passwordVisibleIcon),1)]),(0,r.Lk)("p",T,(0,v.v_)(i.errorMessage),1),(0,r.Lk)("button",{type:"submit",disabled:n.isSubmitting||!i.isFormValid},"–í–æ–π—Ç–∏",8,_)],32)])])}var E=s(782),y=s(1114);class b{}(0,y.A)(b,"VUE_APP_API_URL","https://first-socket-8g1g.onrender.com"),(0,y.A)(b,"refreshTokenUri","/api/v1/auth/refresh"),(0,y.A)(b,"userInfoUri","/api/v1/protected/auth/");var I=b,A=s(4373),C={name:"LoginComponent",data(){return{login:"",password:"",showPassword:!1,error:"",isSubmitting:!1}},computed:{passwordVisibleIcon(){return this.showPassword?"üëÅÔ∏è":"üôà"},errorMessage(){return this.error},passwordInputType(){return this.showPassword?"text":"password"},isFormValid(){return this.login.length>0&&this.password.length>0}},methods:{handleLoginInput(){this.login=event.target.value.replace(/[^A-Za-z0-9!_]/g,"")},handlePasswordInput(){this.password=event.target.value.replace(/[^A-Za-z0-9!_@#$%^&*()]/g,"")},...(0,E.i0)(["loginState"]),async signin(){if(this.isFormValid){this.isSubmitting=!0;try{const e=await A.A.post(`${I.VUE_APP_API_URL}/api/v1/auth/login`,{login:this.login,password:this.password});200===e.status?(this.loginState({userLogin:this.login,accessToken:e.data.access_token,refreshToken:e.data.refresh_token}),this.$router.back().back()):this.error=e.data}catch(e){this.error=e}finally{this.isSubmitting=!1}}},togglePasswordVisibility(){this.showPassword=!this.showPassword}}};const R=(0,l.A)(C,[["render",L],["__scopeId","data-v-2797a8a0"]]);var V=R;const O={class:"signup-container"},U={class:"signup-form"},N={class:"input-wrapper"},$={class:"input-icon"},F={class:"login-status"},q={class:"input-wrapper"},K=["type"],M={class:"input-icon"},x={class:"password-status"},z={class:"input-wrapper"},j=["type"],G={class:"input-icon"},Z={class:"repeat-password-status"},B=["disabled"];function X(e,t,s,o,n,i){return(0,r.uX)(),(0,r.CE)("div",O,[(0,r.Lk)("div",U,[t[9]||(t[9]=(0,r.Lk)("h1",null,"–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è",-1)),(0,r.Lk)("form",{onSubmit:t[8]||(t[8]=(0,a.D$)(((...e)=>i.signup&&i.signup(...e)),["prevent"]))},[(0,r.Lk)("div",N,[(0,r.bo)((0,r.Lk)("input",{type:"text",placeholder:"–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω","onUpdate:modelValue":t[0]||(t[0]=e=>n.login=e),onInput:t[1]||(t[1]=(...e)=>i.handleLoginInput&&i.handleLoginInput(...e)),class:(0,v.C4)(i.loginStateClass),required:""},null,34),[[a.Jo,n.login]]),(0,r.Lk)("span",$,(0,v.v_)(i.loginStateIcon),1)]),(0,r.Lk)("p",F,(0,v.v_)(i.loginErrorMessage),1),(0,r.Lk)("div",q,[(0,r.bo)((0,r.Lk)("input",{type:i.passwordInputType,placeholder:"–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å","onUpdate:modelValue":t[2]||(t[2]=e=>n.password=e),onInput:t[3]||(t[3]=(...e)=>i.handlePasswordInput&&i.handlePasswordInput(...e)),class:(0,v.C4)(i.passwordStateClass),required:""},null,42,K),[[a.hp,n.password]]),(0,r.Lk)("span",{class:"input-icon visibility-icon",onClick:t[4]||(t[4]=(...e)=>i.togglePasswordVisibility&&i.togglePasswordVisibility(...e))},(0,v.v_)(i.passwordVisibleIcon),1),(0,r.Lk)("span",M,(0,v.v_)(i.passwordStateIcon),1)]),(0,r.Lk)("p",x,(0,v.v_)(i.passwordErrorMessage),1),(0,r.Lk)("div",z,[(0,r.bo)((0,r.Lk)("input",{type:i.passwordRepeatInputType,placeholder:"–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å","onUpdate:modelValue":t[5]||(t[5]=e=>n.repeatePassword=e),onInput:t[6]||(t[6]=(...e)=>i.handleRepeatPasswordInput&&i.handleRepeatPasswordInput(...e)),class:(0,v.C4)(i.repeatPasswordStateClass),required:""},null,42,j),[[a.hp,n.repeatePassword]]),(0,r.Lk)("span",{class:"input-icon visibility-icon",onClick:t[7]||(t[7]=(...e)=>i.toggleRepeatPasswordVisibility&&i.toggleRepeatPasswordVisibility(...e))},(0,v.v_)(i.repeatPasswordVisibleIcon),1),(0,r.Lk)("span",G,(0,v.v_)(i.repeatPasswordStateIcon),1)]),(0,r.Lk)("p",Z,(0,v.v_)(i.repeatPasswordErrorMessage),1),(0,r.Lk)("button",{type:"submit",disabled:!i.isFormValid||n.isSubmitting},"–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è",8,B)],32)])])}var D={name:"SignupComponent",data(){return{login:"",password:"",repeatePassword:"",loginState:"default",passwordState:"default",repeatPasswordState:"default",showPassword:!1,showRepeatPassword:!1,loginError:"",passwordError:"",repeatePasswordError:"",loginCheckTimeout:null,isSubmitting:!1}},computed:{loginStateClass(){return{"valid-login":"valid"===this.loginState,"invalid-login":"invalid"===this.loginState,"checking-login":"checking"===this.loginState,"typing-login":"typing"===this.loginState}},loginStateIcon(){switch(this.loginState){case"valid":return"‚úîÔ∏è";case"invalid":return"‚ùå";case"checking":return"‚è≥";case"typing":return"‚úçÔ∏è";default:return"‚ùå"}},loginErrorMessage(){return this.loginError},passwordStateClass(){return{"valid-password":"valid"===this.passwordState,"invalid-password":"invalid"===this.passwordState,"typing-password":"typing"===this.passwordState}},passwordStateIcon(){switch(this.passwordState){case"valid":return"‚úîÔ∏è";case"invalid":return"‚ùå";case"typing":return"‚úçÔ∏è";default:return"‚ùå"}},passwordVisibleIcon(){return this.showPassword?"üëÅÔ∏è":"üôà"},passwordErrorMessage(){return this.passwordError},repeatPasswordStateClass(){return{"valid-repeat-password":"valid"===this.repeatPasswordState,"invalid-repeat-password":"invalid"===this.repeatPasswordState,"typing-repeat-password":"typing"===this.repeatPasswordState}},repeatPasswordStateIcon(){switch(this.repeatPasswordState){case"valid":return"‚úîÔ∏è";case"invalid":return"‚ùå";case"typing":return"‚úçÔ∏è";default:return"‚ùå"}},repeatPasswordVisibleIcon(){return this.showRepeatPassword?"üëÅÔ∏è":"üôà"},repeatPasswordErrorMessage(){return this.repeatePasswordError},isFormValid(){return"valid"===this.loginState&&"valid"===this.passwordState&&"valid"===this.repeatPasswordState},passwordInputType(){return this.showPassword?"text":"password"},passwordRepeatInputType(){return this.showRepeatPassword?"text":"password"}},methods:{handleLoginInput(){if(this.loginState="typing",this.login=event.target.value.replace(/[^A-Za-z0-9!_]/g,""),this.loginError="",clearTimeout(this.loginCheckTimeout),this.login.length<5||this.login.length>32)return this.loginState="invalid",void(this.loginError="–î–ª–∏–Ω–Ω–∞ –ª–æ–≥–∏–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—Ç 5 –¥–æ 32 —Å–∏–º–≤–æ–ª–æ–≤");this.loginCheckTimeout=setTimeout((()=>{this.loginState="checking",this.checkLoginAvailability()}),500)},async checkLoginAvailability(){try{const e=await A.A.get(`${I.VUE_APP_API_URL}/api/v1/auth/availableLogin`,{params:{login:this.login}});e.data.is_available?this.loginState="valid":this.loginState="invalid"}catch(e){console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –ª–æ–≥–∏–Ω–∞:",e),this.loginState="invalid"}},handlePasswordInput(){if(this.passwordState="typing",this.password=event.target.value.replace(/[^A-Za-z0-9!_@#$%^&*()]/g,""),this.passwordError="",this.password.length<8||this.password.length>128)return this.passwordState="invalid",void(this.passwordError="–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç 8 –¥–æ 128 —Å–∏–º–≤–æ–ª–æ–≤");const e=/[A-Z]/.test(this.password),t=/[a-z]/.test(this.password),s=/[0-9]/.test(this.password);return e?t?s?(this.passwordState="valid",void(this.repeatePassword===this.password&&"valid"===this.passwordState?(this.repeatPasswordState="valid",this.repeatePasswordError=""):(this.repeatPasswordState="invalid",this.repeatePasswordError="–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç –∏–ª–∏ –ø–∞—Ä–æ–ª—å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π"))):(this.passwordState="invalid",void(this.passwordError="–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ü–∏—Ñ—Ä—ã")):(this.passwordState="invalid",void(this.passwordError="–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∞–ª–µ–Ω—å–∫–∏–µ –±—É–∫–≤—ã")):(this.passwordState="invalid",void(this.passwordError="–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∑–∞–≥–ª–∞–≤–Ω—ã–µ –±—É–∫–≤—ã"))},handleRepeatPasswordInput(){this.repeatPasswordState="typing",this.repeatePassword=event.target.value.replace(/[^A-Za-z0-9!_@#$%^&*()]/g,""),this.repeatePasswordError="",this.repeatePassword===this.password&&"valid"===this.passwordState?this.repeatPasswordState="valid":(this.repeatPasswordState="invalid",this.repeatePasswordError="–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç –∏–ª–∏ –ø–∞—Ä–æ–ª—å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π")},async signup(){if(this.isFormValid){this.isSubmitting=!0;try{const e={login:this.login,password:this.password},t=await A.A.post(`${I.VUE_APP_API_URL}/api/v1/auth/registr`,e);201===t.status?this.$router.replace("/auth/login"):alert("–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.")}catch(e){console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:",e)}finally{this.isSubmitting=!1}}},togglePasswordVisibility(){this.showPassword=!this.showPassword},toggleRepeatPasswordVisibility(){this.showRepeatPassword=!this.showRepeatPassword}}};const J=(0,l.A)(D,[["render",X],["__scopeId","data-v-6bd6b8fe"]]);var W=J;function H(e,t,s,a,o,n){return(0,r.uX)(),(0,r.CE)("header",null,[(0,r.Lk)("h1",null,"–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, "+(0,v.v_)(e.userLogin),1)])}var Q={name:"AnyComponent",computed:{...(0,E.aH)(["userLogin"])}};const Y=(0,l.A)(Q,[["render",H],["__scopeId","data-v-e2ba3828"]]);var ee=Y;const te={userLogin:"",accessToken:"",refreshToken:""},se={SET_USER_LOGIN(e,{userLogin:t}){e.userLogin=t},CLEAR_USER_LOGIN(e){e.userLogin=""},SET_TOKENS(e,{accessToken:t,refreshToken:s}){e.accessToken=t,e.refreshToken=s},CLEAR_TOKENS(e){e.accessToken="",e.refreshToken=""}},ae={loginState({commit:e},{userLogin:t,accessToken:s,refreshToken:a}){e("SET_USER_LOGIN",{userLogin:t}),e("SET_TOKENS",{accessToken:s,refreshToken:a}),localStorage.setItem("accessToken",s),localStorage.setItem("refreshToken",a)},logout({commit:e}){e("CLEAR_USER_LOGIN"),e("CLEAR_TOKENS"),localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken")},async init({commit:e,dispatch:t,getters:s}){const a=localStorage.getItem("accessToken"),r=localStorage.getItem("refreshToken");if(a&&r){e("SET_TOKENS",{accessToken:a,refreshToken:r});let n=await s.userLoginFromToken;if(""==n)try{await t("updateToken"),n=await s.userLoginFromToken(),""==n?e("CLEAR_TOKENS"):e("SET_USER_LOGIN",{userLogin:n})}catch(o){console.log(o)}else e("SET_USER_LOGIN",{userLogin:n})}else e("CLEAR_TOKENS"),e("CLEAR_USER_LOGIN")},async checkLogin({commit:e,dispatch:t,state:s,getters:a}){if(s.accessToken.length>0&&s.refreshToken.length>0)try{await a.isValidToken||await t("updateToken")}catch(r){e("CLEAR_TOKENS"),e("CLEAR_USER_LOGIN")}},async updateToken({commit:e,getters:t}){try{const s=await A.A.post(`${{NODE_ENV:"production",BASE_URL:"/"}.VUE_APP_BACKEND_URL}/updateToken`,null,{headers:{Authorization:`Bearer ${t.refreshToken}`}});200===s.status?(localStorage.setItem("accessToken",s.data.accessToken),localStorage.setItem("refreshToken",s.data.refreshToken),e("SET_TOKENS",{accessToken:s.data.accessToken,refreshToken:s.data.refreshToken})):(localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),e("SET_TOKENS",{accessToken:"",refreshToken:""}))}catch(s){console.log(s)}}},re={isAuthenticated:e=>()=>""!==e.accessToken,accessToken:e=>e.accessToken,refreshToken:e=>e.refreshToken,isValidToken:async e=>{try{const t=await A.A.get(`${I.VUE_APP_API_URL}${I.userInfoUri}`,{headers:{Authorization:`Bearer ${e.accessToken}`}});return 200===t.status}catch(t){return console.log(t),!1}},userLoginFromToken:async e=>{try{const t=await A.A.get(`${I.VUE_APP_API_URL}${I.userInfoUri}`,{headers:{Authorization:`Bearer ${e.accessToken}`}});return 200===t.status?t.data.login:""}catch(t){return""}}};var oe={state:te,mutations:se,actions:ae,getters:re},ne=new E.Ay.Store({modules:{auth:oe}}),ie=s(1387);const le=[{path:"/",name:"AnyComponent",component:ee,meta:{requiresAuth:!0}},{path:"/auth",name:"AuthComponent",component:w,meta:{requiresAuth:!1}},{path:"/auth/login",name:"LoginComponent",component:V,meta:{requiresAuth:!1}},{path:"/auth/signup",name:"SignupComponent",component:W,meta:{requiresAuth:!1}}],de=(0,ie.aE)({history:(0,ie.LA)(),routes:le});de.beforeEach(((e,t,s)=>{console.log(e.matched.some((e=>e.meta.requiresAuth))),console.log(ne.getters.isAuthenticated()),e.matched.some((e=>e.meta.requiresAuth))?ne.getters.isAuthenticated()?s():s({path:"/auth"}):ne.getters.isAuthenticated()?s(s({path:"/"})):s()}));var pe=de;(0,a.Ef)(p).use(ne).use(pe).mount("#app"),ne.dispatch("init")}},t={};function s(a){var r=t[a];if(void 0!==r)return r.exports;var o=t[a]={exports:{}};return e[a].call(o.exports,o,o.exports,s),o.exports}s.m=e,function(){var e=[];s.O=function(t,a,r,o){if(!a){var n=1/0;for(p=0;p<e.length;p++){a=e[p][0],r=e[p][1],o=e[p][2];for(var i=!0,l=0;l<a.length;l++)(!1&o||n>=o)&&Object.keys(s.O).every((function(e){return s.O[e](a[l])}))?a.splice(l--,1):(i=!1,o<n&&(n=o));if(i){e.splice(p--,1);var d=r();void 0!==d&&(t=d)}}return t}o=o||0;for(var p=e.length;p>0&&e[p-1][2]>o;p--)e[p]=e[p-1];e[p]=[a,r,o]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};s.O.j=function(t){return 0===e[t]};var t=function(t,a){var r,o,n=a[0],i=a[1],l=a[2],d=0;if(n.some((function(t){return 0!==e[t]}))){for(r in i)s.o(i,r)&&(s.m[r]=i[r]);if(l)var p=l(s)}for(t&&t(a);d<n.length;d++)o=n[d],s.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return s.O(p)},a=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=s.O(void 0,[504],(function(){return s(1178)}));a=s.O(a)})();
//# sourceMappingURL=app.c85dd4ae.js.map